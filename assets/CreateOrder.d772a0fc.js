import{d as $e,dh as Be,k as d,dm as Pe,dn as Q,dp as W,dq as j,di as Ee,e as ne,dr as ae,w as oe,u as De,c as Ue,ds as xe,r as c,f as se,b as Le,o as Me,g as v,h as m,i as a,F as re,cP as ie,t as i,dl as B,dt as F,cQ as ce,n as P,x as I,y as Ve,m as le,du as Ke,cR as qe,p as Qe,q as We,dv as je,B as Fe,dw as Ge,dx as He,s as Ye}from"./index.a3c5a5ee.js";import{l as ze,_ as Je,F as Xe,T as Ze,I as et,L as tt,Y as nt,S as at,A as ot}from"./idService.096f6176.js";import st from"./BaseSelectBox.e7e590d5.js";import{_ as ue}from"./BaseRadioGroup.b3beaa81.js";import{P as rt,S as it,a as _,b as de}from"./service-type-enum.bf595476.js";import{L as ct,O as lt}from"./order-service.5ecf97c1.js";import{C as ut}from"./comments-service.768ee57a.js";import{B as dt}from"./list-bank-v2.764adf30.js";import{L as pt}from"./list-application.74b2f8af.js";import"./select_box.05db16a2.js";import"./text_box.c18f19ed.js";const G=w=>(Qe("data-v-7fd54d49"),w=w(),We(),w),ft={class:"container CreateOrder-container",id:"CreateOrder-container"},vt={class:"d-flex"},mt={class:"d-flex flex-wrap service-card-container"},yt={class:"mt-2"},ht={class:"max-price"},gt={class:"input_cus"},Ct=["value","placeholder","onKeyup"],_t=G(()=>a("span",{class:"focus-border"},null,-1)),wt={class:"mt-3"},Nt={class:"max-price"},Tt={class:"input_cus"},kt=["placeholder","value","min","max","onKeyup"],St=G(()=>a("span",{class:"focus-border"},null,-1)),Ot={key:0,class:"mt-3 d-flex justify-content-center"},It={class:"reaction-icon d-flex justify-content-between"},At=["onClick"],bt={key:1,class:"mt-3 input_cus"},Rt={class:"d-flex"},$t={key:0,class:"mt-3 mr-12"},Bt={class:"ml-2"},Pt={key:1,class:"mt-3"},Et={class:"ml-2"},Dt={class:"price-to-pay"},Ut={class:"d-flex justify-content-start"},xt={class:"price"},Lt={class:"total-price-detail"},Mt={key:0},Vt={key:1},Kt={class:"d-flex justify-content-start"},qt={class:"d-flex"},Qt={class:"price"},Wt={class:"d-flex justify-content-start"},jt={class:"btn-buy mb-2",style:{width:"40%"}},Ft={class:"nofi-buy-service"},Gt=G(()=>a("img",{src:Je},null,-1)),Ht=["onClick"],Yt=$e({__name:"CreateOrder",props:{serviceName:{type:String}},setup(w){const pe=w;Be(e=>({"028d93ae":d(Pe),"1d686de4":d(Q),"6e2994aa":d(W),"47b90fcb":d(j)}));const fe=Ee(),E=ne(()=>fe.colorLandingTheme.value);ae(E.value),oe(()=>E.value,async()=>{ae(E.value)},{immediate:!0});const{emit:ve}=je(),h=De(),{t:p}=Ue(),y=new Fe,me=xe(),N=c(!1),T=ne(()=>me.state.userInfo),ye=()=>{N.value=!0},D=c([{begin:0,end:0,value:{kind:1,value:0},status:1,creationTime:null,id:""}]),U=c([]),he=c(se(pt)),zt=c([{ID:0,Name:"Random"}]),x=c(),L=Le();oe(()=>L.path,async e=>{x.value=he.value.find(n=>e.toLowerCase().includes(n.Router.toLowerCase())),z(),Z()},{immediate:!0});const ge=[{type:0,typeName:"Low",resourceKey:"Speed.Low"},{type:1,typeName:"Medium",resourceKey:"Speed.Medium"},{type:2,typeName:"Normal",resourceKey:"Speed.Normal"},{type:3,typeName:"High",resourceKey:"Speed.High"}],H=[{timeUnit:0,timeUnitName:"Day",resoureKey:"TimeUnit.Day"},{timeUnit:1,timeUnitName:"Week",resoureKey:"TimeUnit.Week"},{timeUnit:2,timeUnitName:"Month",resoureKey:"TimeUnit.Month"},{timeUnit:3,timeUnitName:"Year",resoureKey:"TimeUnit.Year"}],A=c(!1),M=c([]),Ce={FacebookIcon:Xe,TiktokIcon:Ze,InstagramIcon:et,LazadaIcon:tt,YoutubeIcon:nt,ShopeeIcon:at,AutoFarmerIcon:ot},_e=[{ReactionName:"like",ReactionIcon:"icon-like",Active:!1},{ReactionName:"love",ReactionIcon:"icon-love",Active:!1},{ReactionName:"care",ReactionIcon:"icon-care",Active:!1},{ReactionName:"haha",ReactionIcon:"icon-haha",Active:!1},{ReactionName:"wow",ReactionIcon:"icon-wow",Active:!1},{ReactionName:"sad",ReactionIcon:"icon-sad",Active:!1},{ReactionName:"angry",ReactionIcon:"icon-angry",Active:!1}],k=c({paymentMethodId:"",amount:0}),Y=c(!1),V=c(!1),g=c({urlService:"",warranty:{timeUnit:0,time:0,price:0},speed:{type:0,price:0},serviceId:"",quantity:0,targets:[],comment:""}),K=c(new Array),f=c(""),b=c({BankName:"",AccountName:"",AccountNumber:""}),we=se(ct);Me(()=>{Ne()});async function C(e=""){return await(h==null?void 0:h.recaptchaLoaded()),await(h==null?void 0:h.executeRecaptcha(e))}async function Ne(){const n={headers:{captcha:await C("GetAllPromotion")}},t=await rt.getAllPromotion(n);t!=null&&t.data&&(D.value=t.data,D.value.length&&D.value.forEach(o=>{o.value&&o.value.kind==1&&(o.valueDisplay=o.value.value*100)}))}async function z(){try{U.value=[];let e=!1;const t={headers:{captcha:await C("GetAllServicePackage")}},o=await it.getServiceByApp(x.value.ID,t);if(o!=null&&o.data){const s=o.data;if((s==null?void 0:s.length)<=0)return;s.forEach(r=>{var ee;r.nameDisplay=p("CreateOrder.ServicePackageName",{name:r.name}),r.quantity=r.minQuantity;const S=r.speeds;(S==null?void 0:S.length)>0&&(r.speed=S[0],S.forEach(u=>{const R=ge.find($=>$.type==u.type);R&&(u.speedDisplay=p(R.resourceKey))}));const O=r.warranties;(O==null?void 0:O.length)>0&&(O.forEach((u,R)=>{var te;u.index=R;const $=H.find(q=>q.timeUnit==u.timeUnit);$&&(u.warrantyDisplay=u.time+" "+p($.resoureKey+(u.time>1?"s":""))),u.timeValue=u.time+" "+((te=H.find(q=>q.timeUnit==u.timeUnit))==null?void 0:te.timeUnitName)+(u.time>1?"s":"")}),r.warranty=O[0]),r.serviceType==_.BuffReaction&&(r.reactions=JSON.parse(JSON.stringify(_e))),r.serviceType==_.BuffComment&&(e=!0),r.icon=(ee=we.find(u=>u.ID==r.serviceType))==null?void 0:ee.Icon});const l=ze.find(r=>L.path.toLowerCase().includes(r.id.toLowerCase()));l&&(U.value=[s.find(r=>r.serviceType==l[L.params.service])]),e&&Z()}}catch(e){console.log("error try: ",e)}}async function Jt(e){var s;e.loadingTopup=!0,k.value.amount=e.end;const t={headers:{captcha:await C("GetPaymentMethod")}},o=await de.getAllPaymentMethod(t);if(o!=null&&o.data){if(M.value=o==null?void 0:o.data,(s=M.value)!=null&&s.length){const l=M.value[0];if(l){const r=l.details;b.value={BankName:r==null?void 0:r.detailId,AccountName:r==null?void 0:r.accountName,AccountNumber:r==null?void 0:r.accountNumber},Te(),k.value.paymentMethodId=l.id}}setTimeout(()=>{A.value=!0,e.loadingTopup=!1},600)}else e.loadingTopup=!1,y.showToastError("No payment method yet!")}function Te(){var o;const e="https://img.vietqr.io/image/<BANK_ID>-<ACCOUNT_NO>-<TEMPLATE>.png?amount=<AMOUNT>&addInfo=<DESCRIPTION>&accountName=<ACCOUNT_NAME>",n=((o=dt.find(s=>s.name==b.value.BankName))==null?void 0:o.bin)||"";f.value=e.replace("<BANK_ID>",n),f.value=f.value.replace("<ACCOUNT_NO>",b.value.AccountNumber),f.value=f.value.replace("<TEMPLATE>","SquX4mZ"),f.value=f.value.replace("<AMOUNT>",k.value.amount.toString());const t=(T.value.surName||"")+" "+(T.value.name||"");f.value=f.value.replace("<DESCRIPTION>",t+" "+p("Payment")),f.value=f.value.replace("<ACCOUNT_NAME>",b.value.BankName)}async function Xt(e){Y.value=!0;const t={headers:{captcha:await C("Payment")}},o=await de.paymentDeposit(k.value,t);o!=null&&o.data?(y.showToastSuccess(p("CreateOrder.TopupSuccess")),Ge.push("/transaction")):y.showToastError(p("CreateOrder.TopupError")),Y.value=!1,A.value=!1}function Zt(e){x.value=e,z()}function J(e,n,t){!t||(t[n]=e.target.value)}function ke(e,n){if(!n)return;const t=n.speeds.findIndex(o=>o.type==e);t>=0&&(n.speed=n.speeds[t])}function Se(e,n){if(!n)return;const t=n.warranties.findIndex(o=>o.index==e);t>=0&&(n.warranty=n.warranties[t])}async function Oe(e){A.value=!1,N.value=!1,e.loadingBuyNow=!0;const n=e;if(n.serviceId=e.id,n.urlService=e.urlService,!Ie(e)){e.loadingBuyNow=!1;return}const s={headers:{captcha:await C("Order")}},l=await lt.order(n,s);l!=null&&l.data?(ve(He.RefreshProfile,!0),y.showToastSuccess(p("CreateOrder.OrderSuccess"))):y.showToastError(p("CreateOrder.OrderError")),e.loadingBuyNow=!1,N.value=!1}function Ie(e){var t,o,s,l,r;const n=e.quantity*(((t=e==null?void 0:e.speed)==null?void 0:t.price)||0+((o=e==null?void 0:e.warranty)==null?void 0:o.price)||0);return((s=T==null?void 0:T.value)==null?void 0:s.balance)<n?(y.showToastWarning(p("ToastNotEnoughBalance")),!1):!e.urlService||e.urlService==""?(y.showToastWarning(p("ToastURLNotEmpty")),!1):e.serviceType==_.BuffComment&&(!e.targets||((l=e.targets)==null?void 0:l.length)==0)?(y.showToastWarning(p("ToastCommentNotEmpty")),!1):e.serviceType==_.BuffReaction&&(!e.targets||((r=e.targets)==null?void 0:r.length)==0)?(y.showToastWarning(p("ToastReactionNotEmpty")),!1):!0}function X(){A.value=!1,N.value=!1}function en(e){return Ce[e]}function Ae(e,n){if(e.targets=e.targets||[],n.Active=!n.Active,n.Active)e.targets.push(n.ReactionName);else{const t=e.targets.indexOf(n.ReactionName);t>=0&&e.targets.splice(t,1)}}function tn(e){!e||(k.value.paymentMethodId=e.id)}function nn(e){setTimeout(()=>{e.component.focus()},0)}function an(e){g.value=e,g.value.targets=g.value.targets||[],V.value=!0}function on(){V.value=!1}function sn(e){e&&(g.value.comment=e,g.value.targets=g.value.comment.split(`
`))}function rn(){V.value=!1}function be(e,n){var t,o;n.commentID=e,n.targets=(o=(t=K.value.find(s=>s.id==e))==null?void 0:t.content)==null?void 0:o.split(`
`)}async function Re(){const e=new URLSearchParams;return{headers:{captcha:await C("GetComment")},params:e}}async function Z(){try{const e=await Re(),n=await ut.getPaging(e);if(n&&n.data){const t=n.data;K.value=t.items}}catch(e){y.showToastError(e==null?void 0:e.message)}}return(e,n)=>(v(),m("div",ft,[a("div",vt,[a("div",mt,[(v(!0),m(re,null,ie(U.value,t=>{var o;return v(),m("div",{key:t,class:"d-flex flex-column justify-content-between",style:{width:"100%"}},[a("div",null,[a("div",null,[a("div",null,[a("div",yt,[a("div",ht,i(e.$t("CreateOrder.AddID")),1),a("div",gt,[a("input",{class:"effect-2",type:"text",value:t.urlService,placeholder:e.$t("CreateOrder.EnterID"),onKeyup:s=>J(s,"urlService",t)},null,40,Ct),_t]),a("div",{class:"mt-1",style:B(`color: ${d(j)}`)},[F(i(e.$t("CreateOrder.GetUID"))+" ",1),a("a",{href:"https://sites.google.com/view/layid/trang-ch%E1%BB%A7",target:"_blank",rel:"noopener noreferrer",style:B(`color: ${d(Q)}`)},i(e.$t("CreateOrder.Here")),5)],4),a("div",wt,[a("div",Nt,i(e.$t("CreateOrder.EnterTurnNumber"))+" Max "+i(e.$filters.number(t.maxQuantity))+" "+i(e.$t("CreateOrder.Turn"))+",\xA0Min "+i(e.$filters.number(t.minQuantity))+" "+i(e.$t("CreateOrder.Turn")),1),a("div",Tt,[a("input",{class:"effect-2",type:"number",placeholder:e.$t("CreateOrder.EnterTurnNumber"),value:t.quantity,min:t.minQuantity,max:t.maxQuantity,onKeyup:s=>J(s,"quantity",t)},null,40,kt),St])])]),t.serviceType==d(_).BuffReaction?(v(),m("div",Ot,[a("div",It,[(v(!0),m(re,null,ie(t.reactions,s=>(v(),m("div",{key:s.ReactionIcon,class:ce(["icon-buff pointer d-flex align-items-center justify-content-center",[s.ReactionName,s.Active?"active":""]]),onClick:l=>Ae(t,s)},[a("span",{class:ce(["icon",s.ReactionIcon])},null,2)],10,At))),128))])])):P("",!0),t.serviceType==d(_).BuffComment?(v(),m("div",bt,[I(st,{class:"effect-2",placeholder:e.$t("CreateOrder.EnterComment"),items:K.value,value:t.commentID,keyID:"id",display:"name",onOnValueChanged:s=>be(s,t)},null,8,["placeholder","items","value","onOnValueChanged"])])):P("",!0),a("div",Rt,[t.speeds?(v(),m("div",$t,[a("span",null,i(e.$t("CreateOrder.ChooseSpeed")),1),a("div",Bt,[I(ue,{keyID:"type",display:"speedDisplay",items:t.speeds,value:t.speed.type,onOnValueChanged:s=>ke(s,t)},null,8,["items","value","onOnValueChanged"])])])):P("",!0),t.warranties.length>0?(v(),m("div",Pt,[a("span",null,i(e.$t("CreateOrder.ChooseWarranty")),1),a("div",Et,[I(ue,{keyID:"index",display:"warrantyDisplay",items:t.warranties,value:t.warranty.index,onOnValueChanged:s=>Se(s,t)},null,8,["items","value","onOnValueChanged"])])])):P("",!0)])])])]),a("div",null,[a("div",Dt,[a("div",Ut,[a("div",null,[a("span",xt,i(e.$t("CreateOrder.AmountToBePaid")),1),a("span",Lt,[t.warranty&&t.warranty.price>0?(v(),m("span",Mt,[a("span",null,i(e.$filters.currency(t.quantity*(t.speed.price+t.warranty.price))),1)])):(v(),m("span",Vt,[a("span",null,i(e.$filters.currency(t.quantity*t.speed.price)),1)]))])])]),a("div",Kt,[a("div",qt,[a("div",Qt,[F(i(e.$t("CreateOrder.Liked"))+" ",1),a("strong",null,i((o=pe.serviceName)==null?void 0:o.toLocaleLowerCase())+" "+i(t.quantity)+" "+i(e.$t("CreateOrder.Turn")),1),F(" "+i(e.$t("CreateOrder.WithPrice"))+" ",1),a("strong",null,i(e.$filters.currency(t.speed.price))+"/"+i(e.$t("CreateOrder.Turn")),1)])])])]),a("div",Wt,[a("div",jt,[I(Ve,{width:"113px",height:"44px",type:"default","styling-mode":"outlined",class:"mt-3 d-flex justify-content-between au-btn-loading",text:e.$t("CreateOrder.BuyNow"),loading:t.loadingBuyNow,onClick:n[0]||(n[0]=s=>ye())},null,8,["text","loading"])]),I(qe,{isVisible:N.value,width:"500px",onClosePopup:X},{content:le(()=>[a("div",Ft,[Gt,a("p",null,i(e.$t("CreateOrder.ConfirmationMessage")),1),a("span",null,i(e.$t("CreateOrder.PayForYourOrder")),1)])]),footer:le(()=>[a("button",{class:"btn-buy-service",onClick:n[1]||(n[1]=s=>X()),style:B(`color: ${d(j)}; background-color: ${d(W)}; border: 1px solid ${d(Ke)}`)},i(e.$t("Cancel")),5),a("button",{style:B(`color: ${d(W)}; background-color: ${d(Q)}`),class:"btn-buy-service",onClick:s=>Oe(t)},i(e.$t("Buy_Service")),13,Ht)]),_:2},1032,["isVisible"])])])])}),128))])])]))}});const Cn=Ye(Yt,[["__scopeId","data-v-7fd54d49"]]);export{Cn as default};
