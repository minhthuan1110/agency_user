import{b7 as lt,aw as ht,be as dt,ay as ft,ca as vt,N as p,de as pt,df as D,c4 as F,a9 as M,dg as j,a0 as y,ax as T,b9 as d,z as k,G as $,D as B,af as G,ah as A,$ as c,a3 as C,aj as W,aq as H,by as U,ae as Y,bG as X,bP as q,bf as z,a2 as O,bB as J,bd as K}from"./index.a3c5a5ee.js";var Q={left:"borderLeftWidth",top:"borderTopWidth",right:"borderRightWidth",bottom:"borderBottomWidth"};var Z=["shading","target","$arrow"],a={left:-1,top:-1,center:0,right:1,bottom:1},L={top:{my:"bottom center",at:"top center",collision:"fit flip"},bottom:{my:"top center",at:"bottom center",collision:"fit flip"},right:{my:"left center",at:"right center",collision:"flip fit"},left:{my:"right center",at:"left center",collision:"flip fit"}},tt={h:10,v:10};class et extends D{constructor(e){var{shading:i,target:o,$arrow:r}=e,s=F(e,Z);super(s),this._props=M({},this._props,{shading:i,target:o}),this._$arrow=r,this._positionSide=void 0,this.updatePosition(this._props.position)}positionWrapper(){this._props.shading&&this._$wrapper.css({top:0,left:0})}updateTarget(e){this._props.target=e,this.updatePosition(this._props.position)}_renderBoundaryOffset(){}_getContainerPosition(){var e=j(this._position.offset||""),{h:i,v:o}=e,r=this._isVerticalSide(),s=this._isHorizontalSide();if(r||s){var f=this._isPopoverInside(),u=(f?-1:1)*a[this._positionSide],l=r?y(this._$arrow):T(this._$arrow),n=this._getContentBorderWidth(this._positionSide),v=u*(l-n);r?o+=v:i+=v}return p({},this._position,{offset:i+" "+o})}_getContentBorderWidth(e){var i=this._$content.css(Q[e]);return parseInt(i)||0}_isPopoverInside(){var e=d.setup.normalizeAlign(this._position.my),i=d.setup.normalizeAlign(this._position.at);return e.h===i.h&&e.v===i.v}_isVerticalSide(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._positionSide;return e==="top"||e==="bottom"}_isHorizontalSide(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._positionSide;return e==="left"||e==="right"}_getDisplaySide(e){var i=d.setup.normalizeAlign(e.my),o=d.setup.normalizeAlign(e.at),r=a[i.h]===a[o.h]&&a[i.v]===a[o.v]?-1:1,s=Math.abs(a[i.h]-r*a[o.h]),f=Math.abs(a[i.v]-r*a[o.v]);return s>f?o.h:o.v}_normalizePosition(e){var i={of:this._props.target,boundaryOffset:tt},o;return k(e)?o=p(!0,{},i,this._positionToObject(e)):o=i,this._positionSide=this._getDisplaySide(o),o}_positionToObject(e){return $(e)?p({},L[e]):e}}var it="dx-popover",ot="dx-popover-wrapper",rt="dx-popover-arrow",st="dx-popover-without-title",x={left:"right",top:"bottom",right:"left",bottom:"top",center:"center"},V=function(t){return B(t)?t.name:t},I=function(t,e){var i=t.option(e);return V(i)},nt=function(t,e){var i=t.option(e);return B(i)&&i.delay},S=function(t,e){var{target:i,shading:o,disabled:r,hideEvent:s}=t.option(),f=$(i),u=o&&e==="hide",l=u?null:I(t,"".concat(e,"Event"));if(u&&s&&G.log("W1020"),!(!l||r)){var n=A(l,t.NAME),v=t._createAction(function(){var h=nt(t,e+"Event");this._clearEventsTimeouts(),h?this._timeouts[e]=setTimeout(function(){t[e]()},h):t[e]()}.bind(t),{validatingTargetName:"target"}),g=function(h){v({event:h,target:c(h.currentTarget)})},_="_"+e+"EventHandler";if(f)t[_]=g,C.on(W.getDocument(),n,i,g);else{var b=H(c(i));t[_]=void 0,C.on(b,n,g)}}},P=function(t,e,i,o){var r=o||I(t,i+"Event");if(!!r){r=A(r,t.NAME);var s="_"+i+"EventHandler";t[s]?C.off(W.getDocument(),r,e,t[s]):C.off(H(c(e)),r)}},R=U.inherit({_getDefaultOptions:function(){return p(this.callBase(),{target:void 0,shading:!1,position:p({},L.bottom),hideOnOutsideClick:!0,animation:{show:{type:"fade",from:0,to:1},hide:{type:"fade",from:1,to:0}},showTitle:!1,width:"auto",height:"auto",dragEnabled:!1,resizeEnabled:!1,fullScreen:!1,hideOnParentScroll:!0,arrowPosition:"",arrowOffset:0,_fixWrapperPosition:!0})},_defaultOptionsRules:function(){return[{device:{platform:"ios"},options:{arrowPosition:{boundaryOffset:{h:20,v:-10},collision:"fit"}}},{device:function(){return!Y()},options:{animation:null}}]},_init:function(){this.callBase(),this._renderArrow(),this._timeouts={},this.$element().addClass(it),this.$wrapper().addClass(ot)},_render:function(){this.callBase.apply(this,arguments),this._detachEvents(this.option("target")),this._attachEvents()},_detachEvents:function(t){P(this,t,"show"),P(this,t,"hide")},_attachEvents:function(){S(this,"show"),S(this,"hide")},_renderArrow:function(){this._$arrow=c("<div>").addClass(rt).prependTo(this.$overlayContent())},_documentDownHandler:function(t){return this._isOutsideClick(t)?this.callBase(t):!0},_isOutsideClick:function(t){return!c(t.target).closest(this.option("target")).length},_animate:function(t){t&&t.to&&typeof t.to=="object"&&p(t.to,{position:this._getContainerPosition()}),this.callBase.apply(this,arguments)},_stopAnimation:function(){this.callBase.apply(this,arguments)},_renderTitle:function(){this.$wrapper().toggleClass(st,!this.option("showTitle")),this.callBase()},_renderPosition:function(){this.callBase(),this._renderOverlayPosition(),this._actions.onPositioned()},_renderOverlayPosition:function(){this._resetOverlayPosition(),this._updateContentSize();var t=this._getContainerPosition(),e=d.setup(this.$overlayContent(),t),i=this._getSideByLocation(e);this._togglePositionClass("dx-position-"+i),this._toggleFlippedClass(e.h.flip,e.v.flip);var o=this._isHorizontalSide()||this._isVerticalSide();o&&this._renderArrowPosition(i)},_resetOverlayPosition:function(){this._setContentHeight(!0),this._togglePositionClass("dx-position-"+this._positionController._positionSide),X(this.$overlayContent(),{left:0,top:0}),this._$arrow.css({top:"auto",right:"auto",bottom:"auto",left:"auto"})},_updateContentSize:function(){if(!!this.$content()){var t=d.calculate(this.$overlayContent(),this._getContainerPosition());if(t.h.oversize>0&&this._isHorizontalSide()&&!t.h.fit){var e=T(this.$overlayContent())-t.h.oversize;q(this.$overlayContent(),e)}if(t.v.oversize>0&&this._isVerticalSide()&&!t.v.fit){var i=y(this.$overlayContent())-t.v.oversize,o=y(this.$content())-t.v.oversize;z(this.$overlayContent(),i),z(this.$content(),o)}}},_getContainerPosition:function(){return this._positionController._getContainerPosition()},_hideOnParentScrollTarget:function(){return c(this._positionController._position.of||this.callBase())},_getSideByLocation:function(t){var e=t.v.flip,i=t.h.flip;return this._isVerticalSide()&&e||this._isHorizontalSide()&&i||this._isPopoverInside()?x[this._positionController._positionSide]:this._positionController._positionSide},_togglePositionClass:function(t){this.$wrapper().removeClass("dx-position-left dx-position-right dx-position-top dx-position-bottom").addClass(t)},_toggleFlippedClass:function(t,e){this.$wrapper().toggleClass("dx-popover-flipped-horizontal",t).toggleClass("dx-popover-flipped-vertical",e)},_renderArrowPosition:function(t){var e=O(this._$arrow.get(0)),i=-(this._isVerticalSide(t)?e.height:e.width);this._$arrow.css(x[t],i);var o=this._isVerticalSide(t)?"left":"top",r=this._isVerticalSide(t)?"width":"height",s=c(this._positionController._position.of),f=d.offset(s)||{top:0,left:0},u=d.offset(this.$overlayContent()),l=e[r],n=u[o],v=O(this.$overlayContent().get(0))[r],g=f[o],_=s.get(0),b=_&&!_.preventDefault?O(_)[r]:0,h=Math.max(n,g),E=Math.min(n+v,g+b),m;this.option("arrowPosition")==="start"?m=h-n:this.option("arrowPosition")==="end"?m=E-n-l:m=(h+E)/2-n-l/2;var w=this._positionController._getContentBorderWidth(t),N=J(m-w+this.option("arrowOffset"),w,v-l-2*w);this._$arrow.css(o,N)},_isPopoverInside:function(){return this._positionController._isPopoverInside()},_setContentHeight:function(t){t&&this.callBase()},_getPositionControllerConfig(){var{shading:t,target:e}=this.option();return p({},this.callBase(),{target:e,shading:t,$arrow:this._$arrow})},_initPositionController(){this._positionController=new et(this._getPositionControllerConfig())},_renderWrapperDimensions:function(){this.option("shading")&&this.$wrapper().css({width:"100%",height:"100%"})},_isVerticalSide:function(t){return this._positionController._isVerticalSide(t)},_isHorizontalSide:function(t){return this._positionController._isHorizontalSide(t)},_clearEventTimeout:function(t){clearTimeout(this._timeouts[t])},_clearEventsTimeouts:function(){this._clearEventTimeout("show"),this._clearEventTimeout("hide")},_clean:function(){this._detachEvents(this.option("target")),this.callBase.apply(this,arguments)},_optionChanged:function(t){switch(t.name){case"arrowPosition":case"arrowOffset":this._renderGeometry();break;case"fullScreen":t.value&&this.option("fullScreen",!1);break;case"target":t.previousValue&&this._detachEvents(t.previousValue),this._positionController.updateTarget(t.value),this._invalidate();break;case"showEvent":case"hideEvent":var e=t.name.substring(0,4),i=V(t.previousValue);this.hide(),P(this,this.option("target"),e,i),S(this,e);break;case"visible":this._clearEventTimeout(t.value?"show":"hide"),this.callBase(t);break;default:this.callBase(t)}},show:function(t){return t&&this.option("target",t),this.callBase()}});K("dxPopover",R);const ct=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{R as P,ct as p};
