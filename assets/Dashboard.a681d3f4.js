import{d as Ae,u as Se,c as Ie,ds as $e,e as Be,r as d,f as ee,o as Re,g as i,h as l,i as n,t as o,F as _,cP as k,x as h,y as $,n as w,cQ as B,k as te,dt as q,m as L,cR as ne,p as Pe,q as Oe,dE as oe,dv as Me,B as Ve,dw as Ue,dx as Le,s as qe}from"./index.a3c5a5ee.js";import{B as Ke}from"./BaseInput.9f8543fa.js";import{B as Fe}from"./BaseNumberBox2.a0cd7526.js";import We from"./BaseSelectBox.e7e590d5.js";import{_ as ae}from"./BaseRadioGroup.b3beaa81.js";import{B as je}from"./BaseTextArea.05bfe592.js";import{P as Qe,S as Ge,a as x,b as se}from"./service-type-enum.bf595476.js";import{L as He,O as Ye}from"./order-service.5ecf97c1.js";import{C as Je}from"./comments-service.768ee57a.js";import{B as ze}from"./list-bank-v2.764adf30.js";import{L as Xe}from"./list-application.74b2f8af.js";import{E as Ze}from"./error-code-enum.da80d5c7.js";import"./text_box.c18f19ed.js";import"./number_box.546ccd32.js";import"./select_box.05db16a2.js";const Q=R=>(Pe("data-v-bb23e645"),R=R(),Oe(),R),et={class:"container dashboard-container"},tt={class:"title text-uppercase mt-0"},nt={key:0},at=oe('<div class="corner-ribbon-container top-right" data-v-bb23e645><div class="corner-ribbon top-right skeleton" data-v-bb23e645></div></div><div class="block-center-between" data-v-bb23e645><div class="topup-icon skeleton" style="width:87px;height:92px;" data-v-bb23e645></div><div class="price-container skeleton" style="width:148px;height:51px;" data-v-bb23e645><div class="price-label" data-v-bb23e645></div><div class="price-number" data-v-bb23e645></div></div></div><div class="w-100 mt-4 skeleton" style="height:40px;" data-v-bb23e645></div>',3),st=[at],ot={class:"corner-ribbon-container top-right"},it={class:"corner-ribbon top-right blue"},lt={key:0,class:"text"},ct={key:1,class:"text"},rt={class:"block-center-between"},dt=Q(()=>n("div",{class:"topup-icon"},[n("span",{class:"icon icon-topup"})],-1)),ut={class:"price-container"},vt={class:"price-label"},pt={class:"price-number"},ht={key:2,class:"mt-3"},mt={class:"title text-uppercase mt-5"},ft={class:"apps mt-2 pb-3"},yt=["onClick"],gt={key:0,class:"d-flex flex-wrap"},bt=oe('<div data-v-bb23e645><div class="d-flex justify-content-between" data-v-bb23e645><div class="skeleton" style="width:150px;height:70px;" data-v-bb23e645></div><div class="icon-service d-flex align-items-center justify-content-center skeleton" data-v-bb23e645></div></div><div class="mt-3" data-v-bb23e645><div class="w-100 skeleton" style="height:55px;border-radius:4px;" data-v-bb23e645></div><div class="mt-3 w-100 skeleton" style="height:36px;border-radius:4px;" data-v-bb23e645></div></div><div class="mt-3 w-100 skeleton" style="height:100px;border-radius:4px;" data-v-bb23e645></div><div class="mt-3 w-100 skeleton" style="height:100px;border-radius:4px;" data-v-bb23e645></div></div><div data-v-bb23e645><div class="mt-3 w-100 skeleton" style="height:55px;border-radius:4px;" data-v-bb23e645></div><div class="btn-buy mb-2" data-v-bb23e645><div class="mt-3 w-100 skeleton" style="height:40px;border-radius:4px;" data-v-bb23e645></div></div></div>',2),_t=[bt],kt={key:1,class:"d-flex flex-wrap"},wt={class:"d-flex justify-content-between"},Ct={class:"service-name"},Nt={class:"price"},Dt={class:"max-price"},Tt={class:"icon-service d-flex align-items-center justify-content-center"},Et={key:0,class:"mt-3"},xt={class:"reaction-icon d-flex justify-content-between"},At=["onClick"],St={class:"mt-3"},It={class:"mt-1"},$t={href:"https://sites.google.com/view/layid/trang-ch%E1%BB%A7",target:"_blank",rel:"noopener noreferrer",style:{color:"rgb(0, 123, 255)"}},Bt={class:"mt-3"},Rt={key:1,class:"mt-3"},Pt={key:2,class:"mt-3"},Ot={class:"ml-2"},Mt={key:3,class:"mt-3"},Vt={class:"ml-2"},Ut={class:"mt-3"},Lt=Q(()=>n("br",null,null,-1)),qt={class:"total-price-detail"},Kt={key:0},Ft={key:1},Wt={class:"btn-buy mb-2"},jt={key:2,class:"mt-3"},Qt=["onClick"],Gt=q(": "),Ht=q(": "),Yt=q(": "),Jt={class:"ml-4",style:{width:"20px"}},zt={key:0,class:"icon icon-check"},Xt=Q(()=>n("div",{class:"modal-add-comment mt-2"},[n("h2",null,"Ghi ch\xFA"),n("div",null,"1. C\u1EE9 m\u1ED7i d\xF2ng t\xEDnh l\xE0 1 comment"),n("div",null,"2. Y\xEAu c\u1EA7u t\u1ED1i thi\u1EBFu 5 comment"),n("div",null,"3. M\u1ECDi n\u1ED9i dung kh\xF4ng ph\xF9 h\u1EE3p \u0111\u1EC1u b\u1ECB t\u1EEB ch\u1ED1i"),n("div",null,"4. H\u1EC7 th\u1ED1ng ch\u1EC9 x\xE9t duy\u1EC7t t\u1EEB 8h s\xE1ng \u0111\u1EBFn 12h \u0111\xEAm h\u1EB1ng ng\xE0y")],-1)),Zt=Ae({__name:"Dashboard",setup(R){const{emit:ie}=Me(),C=Se(),{t:v}=Ie(),f=new Ve,le=$e(),A=Be(()=>le.state.userInfo),S=d([]),N=d([]),G=d(ee(Xe)),en=d([{ID:0,Name:"Random"}]),K=d(G.value[0]),ce=[{type:0,typeName:"Low",resourceKey:"Speed.Low"},{type:1,typeName:"Medium",resourceKey:"Speed.Medium"},{type:2,typeName:"Normal",resourceKey:"Speed.Normal"},{type:3,typeName:"High",resourceKey:"Speed.High"}],H=[{timeUnit:0,timeUnitName:"Day",resoureKey:"TimeUnit.Day"},{timeUnit:1,timeUnitName:"Week",resoureKey:"TimeUnit.Week"},{timeUnit:2,timeUnitName:"Month",resoureKey:"TimeUnit.Month"},{timeUnit:3,timeUnitName:"Year",resoureKey:"TimeUnit.Year"}],D=d(!1),T=d([]),re=[{ReactionName:"like",ReactionIcon:"icon-like",Active:!1},{ReactionName:"love",ReactionIcon:"icon-love",Active:!1},{ReactionName:"care",ReactionIcon:"icon-care",Active:!1},{ReactionName:"haha",ReactionIcon:"icon-haha",Active:!1},{ReactionName:"wow",ReactionIcon:"icon-wow",Active:!1},{ReactionName:"sad",ReactionIcon:"icon-sad",Active:!1},{ReactionName:"angry",ReactionIcon:"icon-angry",Active:!1}],b=d({paymentMethodId:"",amount:0}),F=d(!1),I=d(!1),g=d({urlService:"",warranty:{timeUnit:0,time:0,price:0},speed:{type:0,price:0},serviceId:"",quantity:0,targets:[],comment:""}),W=d(new Array),y=d(""),P=d({BankName:"",AccountName:"",AccountNumber:""}),de=ee(He),O=d(!0),M=d(!0);Re(()=>{ue(),Y()});async function E(e=""){return await(C==null?void 0:C.recaptchaLoaded()),await(C==null?void 0:C.executeRecaptcha(e))}async function ue(){O.value=!0;const s={headers:{captcha:await E("GetAllPromotion")}},t=await Qe.getAllPromotion(s);O.value=!1,t!=null&&t.data&&(S.value=t.data,S.value.length&&S.value.forEach(a=>{a.value&&a.value.kind==1&&(a.valueDisplay=a.value.value*100)}))}async function Y(){M.value=!0,N.value=[];let e=!1;const t={headers:{captcha:await E("GetAllServicePackage")}},a=await Ge.getServiceByApp(K.value.ID,t);if(M.value=!1,a!=null&&a.data){const r=a.data;if((r==null?void 0:r.length)<=0)return;r.forEach(c=>{var X;c.nameDisplay=v("Dashboard.ServicePackageName",{name:c.name}),c.quantity=c.minQuantity;const m=c.speeds;(m==null?void 0:m.length)>0&&(c.speed=m[0],m.forEach(p=>{const V=ce.find(U=>U.type==p.type);V&&(p.speedDisplay=v(V.resourceKey))}));const u=c.warranties;(u==null?void 0:u.length)>0&&(u.forEach((p,V)=>{var Z;p.index=V;const U=H.find(j=>j.timeUnit==p.timeUnit);U&&(p.warrantyDisplay=p.time+" "+v(U.resoureKey+(p.time>1?"s":""))),p.timeValue=p.time+" "+((Z=H.find(j=>j.timeUnit==p.timeUnit))==null?void 0:Z.timeUnitName)+(p.time>1?"s":"")}),c.warranty=u[0]),c.serviceType==x.BuffReaction&&(c.reactions=JSON.parse(JSON.stringify(re))),c.serviceType==x.BuffComment&&(e=!0),c.icon=(X=de.find(p=>p.ID==c.serviceType))==null?void 0:X.Icon}),N.value=r,e&&xe()}}async function ve(e){var r,c;e.loadingTopup=!0,b.value.amount=e.end;const t={headers:{captcha:await E("GetPaymentMethod")}},a=await se.getAllPaymentMethod(t);if(a!=null&&a.data){if(T.value=a==null?void 0:a.data,(r=T.value)!=null&&r.length){const m=T.value[0];if(m){const u=m.details;P.value={BankName:u==null?void 0:u.detailId,AccountName:u==null?void 0:u.accountName,AccountNumber:u==null?void 0:u.accountNumber},b.value.paymentMethodId=m.id}((c=T.value)==null?void 0:c.length)==1?J():D.value=!0}else f.showToastWarning(v("Dashboard.NoPaymentMethod"));e.loadingTopup=!1}else e.loadingTopup=!1,f.showToastWarning(v("Dashboard.NoPaymentMethod"))}function tn(){var a;const e="https://img.vietqr.io/image/<BANK_ID>-<ACCOUNT_NO>-<TEMPLATE>.png?amount=<AMOUNT>&addInfo=<DESCRIPTION>&accountName=<ACCOUNT_NAME>",s=((a=ze.find(r=>r.name==P.value.BankName))==null?void 0:a.bin)||"";y.value=e.replace("<BANK_ID>",s),y.value=y.value.replace("<ACCOUNT_NO>",P.value.AccountNumber),y.value=y.value.replace("<TEMPLATE>","SquX4mZ"),y.value=y.value.replace("<AMOUNT>",b.value.amount.toString());const t=(A.value.surName||"")+" "+(A.value.name||"");y.value=y.value.replace("<DESCRIPTION>",t+" "+v("Payment")),y.value=y.value.replace("<ACCOUNT_NAME>",P.value.BankName)}async function J(){F.value=!0;const s={headers:{captcha:await E("Payment")}},t=await se.paymentDeposit(b.value,s);t!=null&&t.data?Ue.push({name:"Transaction",query:{id:t==null?void 0:t.data.id}}):(t==null?void 0:t.errorCode)==Ze.DepositTooFast?f.showToastWarning(v("Dashboard.DepositTooFast")):f.showToastError(v("Dashboard.TopupError")),F.value=!1,D.value=!1}function pe(e){K.value=e,Y()}function z(e,s,t){!t||(t[s]=e)}function he(e,s){if(!s)return;const t=s.speeds.findIndex(a=>a.type==e);t>=0&&(s.speed=s.speeds[t])}function me(e,s){if(!s)return;const t=s.warranties.findIndex(a=>a.index==e);t>=0&&(s.warranty=s.warranties[t])}async function fe(e){e.loadingBuyNow=!0;const s=e;if(s.serviceId=e.id,s.urlService=e.urlService,!ge(e)){e.loadingBuyNow=!1;return}const r={headers:{captcha:await E("Order")}},c=await Ye.order(s,r);c!=null&&c.data?(ye(c==null?void 0:c.data),f.showToastSuccess(v("Dashboard.OrderSuccess"))):f.showToastError(v("Dashboard.OrderError")),e.loadingBuyNow=!1}function ye(e){const s=N.value.findIndex(t=>{var a;return t.id==((a=e==null?void 0:e.service)==null?void 0:a.id)});s>=0&&(N.value[s].urlService=""),ie(Le.RefreshProfile,!0)}function ge(e){var t,a,r,c,m;const s=e.quantity*(((t=e==null?void 0:e.speed)==null?void 0:t.price)||0+((a=e==null?void 0:e.warranty)==null?void 0:a.price)||0);return((r=A==null?void 0:A.value)==null?void 0:r.balance)<s?(f.showToastWarning(v("ToastNotEnoughBalance")),!1):!e.urlService||e.urlService==""?(f.showToastWarning(v("ToastURLNotEmpty")),!1):e.serviceType==x.BuffComment&&(!e.targets||((c=e.targets)==null?void 0:c.length)==0)?(f.showToastWarning(v("ToastCommentNotEmpty")),!1):e.serviceType==x.BuffReaction&&(!e.targets||((m=e.targets)==null?void 0:m.length)==0)?(f.showToastWarning(v("ToastReactionNotEmpty")),!1):!0}function be(){D.value=!1}function _e(e,s){if(e.targets=e.targets||[],s.Active=!s.Active,s.Active)e.targets.push(s.ReactionName);else{const t=e.targets.indexOf(s.ReactionName);t>=0&&e.targets.splice(t,1)}}function ke(e){!e||(b.value.paymentMethodId=e.id)}function we(e){setTimeout(()=>{e.component.focus()},0)}function nn(e){g.value=e,g.value.targets=g.value.targets||[],I.value=!0}function Ce(){I.value=!1}function Ne(e){e&&(g.value.comment=e,g.value.targets=g.value.comment.split(`
`))}function De(){I.value=!1}function Te(e,s){var t,a;s.commentID=e,s.targets=(a=(t=W.value.find(r=>r.id==e))==null?void 0:t.content)==null?void 0:a.split(`
`)}async function Ee(){const e=new URLSearchParams;return{headers:{captcha:await E("GetComment")},params:e}}async function xe(){try{const e=await Ee(),s=await Je.getPaging(e);if(s&&s.data){const t=s.data;W.value=t.items}}catch(e){f.showToastError(e==null?void 0:e.message)}}return(e,s)=>(i(),l("div",et,[n("div",null,[n("div",tt,o(e.$t("Dashboard.Topup")),1),O.value?(i(),l("div",nt,[(i(),l(_,null,k([1,2,3,4,5,6],t=>n("div",{key:t,class:"topup-card-container"},st)),64))])):(i(!0),l(_,{key:1},k(S.value,t=>(i(),l("div",{key:t.id,class:"topup-card-container"},[n("div",ot,[n("div",it,[t.value.kind==1?(i(),l("span",lt,"+"+o(t.valueDisplay)+"%",1)):(i(),l("span",ct,"+"+o(e.$filters.currency(t.value.value)),1))])]),n("div",rt,[dt,n("div",ut,[n("div",vt,o(e.$t("Dashboard.Topup")),1),n("div",pt,o(e.$filters.number(t.end))+" VN\u0110",1)])]),h($,{width:"100%",height:"40px",type:"default","styling-mode":"outlined",class:"mt-4",text:e.$t("Dashboard.TopupNow"),loading:t.loadingTopup,onClick:a=>ve(t)},null,8,["text","loading","onClick"])]))),128)),!O.value&&S.value.length==0?(i(),l("div",ht,o(e.$t("Common.NoDataText")),1)):w("",!0)]),n("div",null,[n("div",mt,o(e.$t("Dashboard.PurchaseServices")),1),n("div",ft,[(i(!0),l(_,null,k(G.value,t=>(i(),l("div",{key:t.ID,class:B(["app",{appActive:t.ID==K.value.ID}]),onClick:a=>pe(t)},o(t.Name),11,yt))),128))]),M.value?(i(),l("div",gt,[(i(),l(_,null,k([1,2,3,4],t=>n("div",{key:t,class:"service-card-container d-flex flex-column justify-content-between mt-4 mr-4"},_t)),64))])):(i(),l("div",kt,[(i(!0),l(_,null,k(N.value,t=>(i(),l("div",{key:t.id,class:"service-card-container d-flex flex-column justify-content-between mt-4 mr-4"},[n("div",null,[n("div",wt,[n("div",null,[n("div",Ct,o(t.nameDisplay),1),n("div",Nt,o(e.$t("Dashboard.Only"))+" "+o(e.$filters.currency(t.speed.price))+"/"+o(e.$t("Dashboard.Turn")),1),n("div",Dt," Max "+o(e.$filters.number(t.maxQuantity))+" "+o(e.$t("Dashboard.Turn"))+",\xA0Min "+o(e.$filters.number(t.minQuantity))+" "+o(e.$t("Dashboard.Turn")),1)]),n("div",Tt,[n("div",{class:B(["icon",t.icon])},null,2)])]),t.serviceType==te(x).BuffReaction?(i(),l("div",Et,[n("div",xt,[(i(!0),l(_,null,k(t.reactions,a=>(i(),l("div",{key:a.ReactionIcon,class:B(["icon-buff pointer d-flex align-items-center justify-content-center",[a.ReactionName,a.Active?"active":""]]),onClick:r=>_e(t,a)},[n("span",{class:B(["icon",a.ReactionIcon])},null,2)],10,At))),128))])])):w("",!0),n("div",St,[h(Ke,{placeholder:e.$t("Dashboard.EnterID"),value:t.urlService,onOnValueChanged:a=>z(a,"urlService",t)},null,8,["placeholder","value","onOnValueChanged"]),n("div",It,[q(o(e.$t("Dashboard.GetUID"))+" ",1),n("a",$t,o(e.$t("Dashboard.Here")),1)]),n("div",Bt,[h(Fe,{placeholder:e.$t("Dashboard.EnterTurnNumber"),value:t.quantity,min:t.minQuantity,max:t.maxQuantity,onOnValueChanged:a=>z(a,"quantity",t)},null,8,["placeholder","value","min","max","onOnValueChanged"])])]),t.serviceType==te(x).BuffComment?(i(),l("div",Rt,[h(We,{placeholder:e.$t("Dashboard.EnterComment"),items:W.value,value:t.commentID,keyID:"id",display:"name",onOnValueChanged:a=>Te(a,t)},null,8,["placeholder","items","value","onOnValueChanged"])])):w("",!0),t.speeds?(i(),l("div",Pt,[n("span",null,o(e.$t("Dashboard.ChooseSpeed")),1),n("div",Ot,[h(ae,{keyID:"type",display:"speedDisplay",items:t.speeds,value:t.speed.type,onOnValueChanged:a=>he(a,t)},null,8,["items","value","onOnValueChanged"])])])):w("",!0),t.warranties.length>0?(i(),l("div",Mt,[n("span",null,o(e.$t("Dashboard.ChooseWarranty")),1),n("div",Vt,[h(ae,{keyID:"index",display:"warrantyDisplay",items:t.warranties,value:t.warranty.index,onOnValueChanged:a=>me(a,t)},null,8,["items","value","onOnValueChanged"])])])):w("",!0)]),n("div",null,[n("div",Ut,[n("span",null,o(e.$t("Dashboard.TotalPrice")),1),Lt,n("div",qt,[t.warranty&&t.warranty.price>0?(i(),l("div",Kt,[n("span",null,o(e.$filters.number(t.quantity))+" x ("+o(e.$filters.currency(t.speed.price))+" + "+o(e.$filters.currency(t.warranty.price))+") = ",1),n("span",null,o(e.$filters.currency(t.quantity*(t.speed.price+t.warranty.price))),1)])):(i(),l("div",Ft,[n("span",null,o(e.$filters.number(t.quantity))+" x "+o(e.$filters.currency(t.speed.price))+" = ",1),n("span",null,o(e.$filters.currency(t.quantity*t.speed.price)),1)]))])]),n("div",Wt,[h($,{width:"100%",height:"40px",type:"default","styling-mode":"outlined",class:"mt-3",text:e.$t("Dashboard.BuyNow"),loading:t.loadingBuyNow,onClick:a=>fe(t)},null,8,["text","loading","onClick"])])])]))),128))])),!M.value&&N.value.length==0?(i(),l("div",jt,o(e.$t("Common.NoDataText")),1)):w("",!0)]),h(ne,{"v-if":D.value,isVisible:D.value,title:e.$t("Dashboard.SelectPaymentMethod"),onClosePopup:be},{content:L(()=>[n("div",null,[(i(!0),l(_,null,k(T.value,t=>(i(),l("div",{key:t.id,class:B(["payment-method-item d-flex justify-content-between align-items-center",{active:t.id==b.value.paymentMethodId}]),onClick:a=>ke(t)},[n("div",null,[n("div",null,[n("span",null,o(e.$t("BankName")),1),Gt,n("span",null,o(t.details.detailId),1)]),n("div",null,[n("span",null,o(e.$t("AccountName")),1),Ht,n("span",null,o(t.details.accountName),1)]),n("div",null,[n("span",null,o(e.$t("AccountNumber")),1),Yt,n("span",null,o(t.details.accountNumber),1)])]),n("div",Jt,[t.id==b.value.paymentMethodId?(i(),l("span",zt)):w("",!0)])],10,Qt))),128))])]),footer:L(()=>[h($,{class:"mr-2",text:e.$t("Cancel"),type:"normal","styling-mode":"outlined",onClick:s[0]||(s[0]=t=>D.value=!1)},null,8,["text"]),h($,{text:e.$t("Common.Next"),type:"default","styling-mode":"contained",loading:F.value,disabled:T.value.length==0,onClick:s[1]||(s[1]=t=>J())},null,8,["text","loading","disabled"])]),_:1},8,["v-if","isVisible","title"]),h(ne,{"v-if":I.value,isVisible:I.value,title:e.$t("AddComment"),customClass:"popup-comment",width:"500px",onClosePopup:De},{content:L(()=>[n("div",null,[h(je,{placeholder:"Enter comment list",value:g.value.comment,onOnValueChanged:s[2]||(s[2]=t=>Ne(t)),onOnContentReady:we},null,8,["value"])]),Xt]),footer:L(()=>[h($,{type:"default","styling-mode":"contained",text:e.$t("Save"),disabled:g.value.targets.length<5,onClick:Ce},null,8,["text","disabled"])]),_:1},8,["v-if","isVisible","title"])]))}});const bn=qe(Zt,[["__scopeId","data-v-bb23e645"]]);export{bn as default};
