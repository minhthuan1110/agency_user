import{d as ye,di as ge,e as O,u as Ne,c as Te,ds as Ce,r as u,f as H,o as Ee,g as w,h as A,i as a,t as d,F as _e,cP as we,x as h,y as x,m as P,dl as Ae,k as Q,cR as Y,p as be,q as ke,dt as b,dv as Se,B as De,dw as Re,dx as Be,s as xe}from"./index.a3c5a5ee.js";import{B as Pe}from"./BaseTextArea.05bfe592.js";import{P as Ie,S as Ue,a as I,b as J}from"./service-type-enum.bf595476.js";import{L as Me,O as Oe}from"./order-service.5ecf97c1.js";import{C as $e}from"./comments-service.768ee57a.js";import{B as Ve}from"./list-bank-v2.764adf30.js";import{L as Le}from"./list-application.74b2f8af.js";import{E as Ke}from"./error-code-enum.da80d5c7.js";import"./text_box.c18f19ed.js";const z=k=>(be("data-v-814dcd96"),k=k(),ke(),k),Fe={class:"container dashboard-container"},We={class:"title text-uppercase mt-0"},qe={class:"corner-ribbon-container top-right"},Ge={class:"corner-ribbon top-right blue"},He={key:0,class:"text"},Qe={key:1,class:"text"},Ye={class:"block-center-between"},Je=z(()=>a("div",{class:"topup-icon"},[a("span",{class:"icon icon-topup"})],-1)),ze={class:"price-container"},Xe={class:"price-label"},Ze={class:"price-number"},je=["src"],et=b(": "),tt={class:"text-bold"},nt=b(": "),ot={class:"text-bold"},at=b(": "),st={class:"text-bold"},it=b(": "),ct={class:"text-bold"},lt=b(" VN\u0110 "),ut=z(()=>a("div",{class:"modal-add-comment mt-2"},[a("h2",null,"Ghi ch\xFA"),a("div",null,"1. C\u1EE9 m\u1ED7i d\xF2ng t\xEDnh l\xE0 1 comment"),a("div",null,"2. Y\xEAu c\u1EA7u t\u1ED1i thi\u1EBFu 5 comment"),a("div",null,"3. M\u1ECDi n\u1ED9i dung kh\xF4ng ph\xF9 h\u1EE3p \u0111\u1EC1u b\u1ECB t\u1EEB ch\u1ED1i"),a("div",null,"4. H\u1EC7 th\u1ED1ng ch\u1EC9 x\xE9t duy\u1EC7t t\u1EEB 8h s\xE1ng \u0111\u1EBFn 12h \u0111\xEAm h\u1EB1ng ng\xE0y")],-1)),rt=ye({__name:"Dashboard_Theme4",setup(k){const $=ge(),X=O(()=>$.color.value),Z=O(()=>$.colorText.value),{emit:j}=Se(),y=Ne(),{t:r}=Te(),p=new De,ee=Ce(),C=O(()=>ee.state.userInfo),S=u([{begin:0,end:0,value:{kind:1,value:0},status:1,creationTime:null,id:""}]),V=u([]),te=u(H(Le)),dt=u([{ID:0,Name:"Random"}]),L=u(te.value[0]),ne=[{type:0,typeName:"Low",resourceKey:"Speed.Low"},{type:1,typeName:"Medium",resourceKey:"Speed.Medium"},{type:2,typeName:"Normal",resourceKey:"Speed.Normal"},{type:3,typeName:"High",resourceKey:"Speed.High"}],K=[{timeUnit:0,timeUnitName:"Day",resoureKey:"TimeUnit.Day"},{timeUnit:1,timeUnitName:"Week",resoureKey:"TimeUnit.Week"},{timeUnit:2,timeUnitName:"Month",resoureKey:"TimeUnit.Month"},{timeUnit:3,timeUnitName:"Year",resoureKey:"TimeUnit.Year"}],g=u(!1),D=u([]),oe=[{ReactionName:"like",ReactionIcon:"icon-like",Active:!1},{ReactionName:"love",ReactionIcon:"icon-love",Active:!1},{ReactionName:"care",ReactionIcon:"icon-care",Active:!1},{ReactionName:"haha",ReactionIcon:"icon-haha",Active:!1},{ReactionName:"wow",ReactionIcon:"icon-wow",Active:!1},{ReactionName:"sad",ReactionIcon:"icon-sad",Active:!1},{ReactionName:"angry",ReactionIcon:"icon-angry",Active:!1}],N=u({paymentMethodId:"",amount:0}),U=u(!1),E=u(!1),v=u({urlService:"",warranty:{timeUnit:0,time:0,price:0},speed:{type:0,price:0},serviceId:"",quantity:0,targets:[],comment:""}),F=u(new Array),m=u(""),f=u({BankName:"",AccountName:"",AccountNumber:""}),ae=H(Me);Ee(()=>{se(),W()});async function T(e=""){return await(y==null?void 0:y.recaptchaLoaded()),await(y==null?void 0:y.executeRecaptcha(e))}async function se(){const t={headers:{captcha:await T("GetAllPromotion")}},n=await Ie.getAllPromotion(t);n!=null&&n.data&&(S.value=n.data,S.value.length&&S.value.forEach(o=>{o.value&&o.value.kind==1&&(o.valueDisplay=o.value.value*100)}))}async function W(){V.value=[];let e=!1;const n={headers:{captcha:await T("GetAllServicePackage")}},o=await Ue.getServiceByApp(L.value.ID,n);if(o!=null&&o.data){const c=o.data;if((c==null?void 0:c.length)<=0)return;c.forEach(s=>{var q;s.nameDisplay=r("Dashboard.ServicePackageName",{name:s.name}),s.quantity=s.minQuantity;const i=s.speeds;(i==null?void 0:i.length)>0&&(s.speed=i[0],i.forEach(l=>{const R=ne.find(B=>B.type==l.type);R&&(l.speedDisplay=r(R.resourceKey))}));const _=s.warranties;(_==null?void 0:_.length)>0&&(_.forEach((l,R)=>{var G;l.index=R;const B=K.find(M=>M.timeUnit==l.timeUnit);B&&(l.warrantyDisplay=l.time+" "+r(B.resoureKey+(l.time>1?"s":""))),l.timeValue=l.time+" "+((G=K.find(M=>M.timeUnit==l.timeUnit))==null?void 0:G.timeUnitName)+(l.time>1?"s":"")}),s.warranty=_[0]),s.serviceType==I.BuffReaction&&(s.reactions=JSON.parse(JSON.stringify(oe))),s.serviceType==I.BuffComment&&(e=!0),s.icon=(q=ae.find(l=>l.ID==s.serviceType))==null?void 0:q.Icon}),V.value=c,e&&he()}}async function ie(e){var c;e.loadingTopup=!0,N.value.amount=e.end;const n={headers:{captcha:await T("GetPaymentMethod")}},o=await J.getAllPaymentMethod(n);if(o!=null&&o.data){if(D.value=o==null?void 0:o.data,(c=D.value)!=null&&c.length){const s=D.value[0];if(s){const i=s.details;f.value={BankName:i==null?void 0:i.detailId,AccountName:i==null?void 0:i.accountName,AccountNumber:i==null?void 0:i.accountNumber},ce(),N.value.paymentMethodId=s.id}}setTimeout(()=>{g.value=!0,e.loadingTopup=!1},600)}else e.loadingTopup=!1,p.showToastError("No payment method yet!")}function ce(){var o;const e="https://img.vietqr.io/image/<BANK_ID>-<ACCOUNT_NO>-<TEMPLATE>.png?amount=<AMOUNT>&addInfo=<DESCRIPTION>&accountName=<ACCOUNT_NAME>",t=((o=Ve.find(c=>c.name==f.value.BankName))==null?void 0:o.bin)||"";m.value=e.replace("<BANK_ID>",t),m.value=m.value.replace("<ACCOUNT_NO>",f.value.AccountNumber),m.value=m.value.replace("<TEMPLATE>","SquX4mZ"),m.value=m.value.replace("<AMOUNT>",N.value.amount.toString());const n=(C.value.surName||"")+" "+(C.value.name||"");m.value=m.value.replace("<DESCRIPTION>",n+" "+r("Payment")),m.value=m.value.replace("<ACCOUNT_NAME>",f.value.BankName)}async function le(e){U.value=!0;const n={headers:{captcha:await T("Payment")}},o=await J.paymentDeposit(N.value,n);o!=null&&o.data?(p.showToastSuccess(r("Dashboard.TopupSuccess")),Re.push("/transaction")):(o==null?void 0:o.errorCode)==Ke.DepositTooFast?p.showToastWarning(r("Dashboard.DepositTooFast")):p.showToastError(r("Dashboard.TopupError")),U.value=!1,g.value=!1}function mt(e){L.value=e,W()}function pt(e,t,n){!n||(n[t]=e)}function vt(e,t){if(!t)return;const n=t.speeds.findIndex(o=>o.type==e);n>=0&&(t.speed=t.speeds[n])}function ft(e,t){if(!t)return;const n=t.warranties.findIndex(o=>o.index==e);n>=0&&(t.warranty=t.warranties[n])}async function ht(e){e.loadingBuyNow=!0;const t=e;if(t.serviceId=e.id,t.urlService=e.urlService,!ue(e)){e.loadingBuyNow=!1;return}const c={headers:{captcha:await T("Order")}},s=await Oe.order(t,c);s!=null&&s.data?(j(Be.RefreshProfile,!0),p.showToastSuccess(r("Dashboard.OrderSuccess"))):p.showToastError(r("Dashboard.OrderError")),e.loadingBuyNow=!1}function ue(e){var n,o,c,s,i;const t=e.quantity*(((n=e==null?void 0:e.speed)==null?void 0:n.price)||0+((o=e==null?void 0:e.warranty)==null?void 0:o.price)||0);return((c=C==null?void 0:C.value)==null?void 0:c.balance)<t?(p.showToastWarning(r("ToastNotEnoughBalance")),!1):!e.urlService||e.urlService==""?(p.showToastWarning(r("ToastURLNotEmpty")),!1):e.serviceType==I.BuffComment&&(!e.targets||((s=e.targets)==null?void 0:s.length)==0)?(p.showToastWarning(r("ToastCommentNotEmpty")),!1):e.serviceType==I.BuffReaction&&(!e.targets||((i=e.targets)==null?void 0:i.length)==0)?(p.showToastWarning(r("ToastReactionNotEmpty")),!1):!0}function re(){g.value=!1}function yt(e,t){if(e.targets=e.targets||[],t.Active=!t.Active,t.Active)e.targets.push(t.ReactionName);else{const n=e.targets.indexOf(t.ReactionName);n>=0&&e.targets.splice(n,1)}}function gt(e){!e||(N.value.paymentMethodId=e.id)}function de(e){setTimeout(()=>{e.component.focus()},0)}function Nt(e){v.value=e,v.value.targets=v.value.targets||[],E.value=!0}function me(){E.value=!1}function pe(e){e&&(v.value.comment=e,v.value.targets=v.value.comment.split(`
`))}function ve(){E.value=!1}function Tt(e,t){var n,o;t.commentID=e,t.targets=(o=(n=F.value.find(c=>c.id==e))==null?void 0:n.content)==null?void 0:o.split(`
`)}async function fe(){const e=new URLSearchParams;return{headers:{captcha:await T("GetComment")},params:e}}async function he(){try{const e=await fe(),t=await $e.getPaging(e);if(t&&t.data){const n=t.data;F.value=n.items}}catch(e){p.showToastError(e==null?void 0:e.message)}}return(e,t)=>(w(),A("div",Fe,[a("div",null,[a("div",We,d(e.$t("Dashboard.Topup")),1),(w(!0),A(_e,null,we(S.value,n=>(w(),A("div",{key:n.id,class:"topup-card-container"},[a("div",qe,[a("div",Ge,[n.value.kind==1?(w(),A("span",He,"+"+d(n.valueDisplay)+"%",1)):(w(),A("span",Qe,"+"+d(e.$filters.currency(n.value.value)),1))])]),a("div",Ye,[Je,a("div",ze,[a("div",Xe,d(e.$t("Dashboard.Topup")),1),a("div",Ze,d(e.$filters.number(n.end))+" VN\u0110",1)])]),h(x,{width:"100%",height:"40px",type:"default","styling-mode":"outlined",class:"mt-4",text:e.$t("Dashboard.TopupNow"),loading:n.loadingTopup,onClick:o=>ie(n)},null,8,["text","loading","onClick"])]))),128))]),h(Y,{"v-if":g.value,isVisible:g.value,title:e.$t("Payment"),onClosePopup:re},{content:P(()=>[a("div",null,[a("img",{src:m.value},null,8,je),a("div",null,[a("div",null,[a("span",null,d(e.$t("BankName")),1),et,a("span",tt,d(f.value.BankName),1)]),a("div",null,[a("span",null,d(e.$t("AccountName")),1),nt,a("span",ot,d(f.value.AccountName),1)]),a("div",null,[a("span",null,d(e.$t("AccountNumber")),1),at,a("span",st,d(f.value.AccountNumber),1)]),a("div",null,[a("span",null,d(e.$t("AmountMoney")),1),it,a("span",ct,d(e.$filters.number(N.value.amount)),1),lt])])])]),footer:P(()=>[h(x,{class:"mr-2",text:e.$t("Cancel"),type:"normal","styling-mode":"outlined",onClick:t[0]||(t[0]=n=>g.value=!1)},null,8,["text"]),h(x,{text:e.$t("ConfirmPayment"),style:Ae(`background-color: ${Q(X)}; color: ${Q(Z)}`),"styling-mode":"contained",loading:U.value,disabled:D.value.length==0,onClick:t[1]||(t[1]=n=>le())},null,8,["text","style","loading","disabled"])]),_:1},8,["v-if","isVisible","title"]),h(Y,{"v-if":E.value,isVisible:E.value,title:e.$t("AddComment"),customClass:"popup-comment",width:"500px",onClosePopup:ve},{content:P(()=>[a("div",null,[h(Pe,{placeholder:"Enter comment list",value:v.value.comment,onOnValueChanged:t[2]||(t[2]=n=>pe(n)),onOnContentReady:de},null,8,["value"])]),ut]),footer:P(()=>[h(x,{type:"default","styling-mode":"contained",text:e.$t("Save"),disabled:v.value.targets.length<5,onClick:me},null,8,["text","disabled"])]),_:1},8,["v-if","isVisible","title"])]))}});const Rt=xe(rt,[["__scopeId","data-v-814dcd96"]]);export{Rt as default};
